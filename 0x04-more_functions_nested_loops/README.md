More fuctions, more nested loops
